{% extends "base.html" %}

{% block title %}Comments{% endblock %}

{% block content %}
<div class="container">
    <h1>Comments</h1>
    <div class="comment-controls">
        <button onclick="showAddCommentForm()" class="btn">Add Comment</button>
    </div>
    <div id="commentList" class="comment-list"></div>
</div>

<div id="addCommentModal" class="modal" style="display: none;">
    <div class="modal-content">
        <h2>Add New Comment</h2>
        <form id="addCommentForm" onsubmit="handleAddComment(event)">
            <div class="form-group">
                <label for="commentID">Comment ID:</label>
                <input type="number" id="commentID" name="commentID" required>
            </div>
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="reviewID">Review ID:</label>
                <input type="text" id="reviewID" name="reviewID" required>
            </div>
            <div class="form-group">
                <label for="description">Description:</label>
                <textarea id="description" name="description" required></textarea>
            </div>
            <button type="submit" class="btn">Add Comment</button>
            <button type="button" class="btn" onclick="hideAddCommentForm()">Cancel</button>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', async () => {
    const loadComments = async () => {
        const comments = await fetchData('comments');
        const commentList = document.getElementById('commentList');
        commentList.innerHTML = comments.map(comment => `
            <div class="comment-item">
                <h3>Comment #${comment.commentID}</h3>
                <p>By: ${comment.username}</p>
                <p>${comment.description}</p>
                <button onclick="editComment(${comment.commentID})" class="btn btn-warning">Edit</button>
                <button onclick="deleteComment(${comment.commentID})" class="btn btn-danger">Delete</button>
            </div>
        `).join('');
    };

    loadComments();
});
</script>
{% endblock %}