{% extends "base.html" %}

{% block title %}Reviews{% endblock %}

{% block content %}
<div class="container">
    <h1>Reviews</h1>
    <div class="review-controls">
        <button onclick="showAddReviewForm()" class="btn">Add Review</button>
    </div>
    <div id="reviewList" class="review-list"></div>
</div>

<div id="addReviewModal" class="modal" style="display: none;">
    <div class="modal-content">
        <h2>Add New Review</h2>
        <form id="addReviewForm" onsubmit="handleAddReview(event)">
            <div class="form-group">
                <label for="username">Username:</label>
                <input type="text" id="username" name="username" required>
            </div>
            <div class="form-group">
                <label for="rating">Rating:</label>
                <input type="number" id="rating" name="rating" min="1" max="5" required>
            </div>
            <div class="form-group">
                <label for="description">Description:</label>
                <textarea id="description" name="description" required></textarea>
            </div>
            <button type="submit" class="btn">Add Review</button>
            <button type="button" class="btn" onclick="hideAddReviewForm()">Cancel</button>
        </form>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', async () => {
    const loadReviews = async () => {
        const reviews = await fetchData('reviews');
        const reviewList = document.getElementById('reviewList');
        reviewList.innerHTML = reviews.map(review => `
            <div class="review-item">
                <h3>Review by ${review.username}</h3>
                <p>Rating: ${review.rating}/5</p>
                <p>${review.description}</p>
                <button onclick="editReview('${review.reviewID}')" class="btn btn-warning">Edit</button>
                <button onclick="deleteReview('${review.reviewID}')" class="btn btn-danger">Delete</button>
            </div>
        `).join('');
    };

    loadReviews();
});
</script>
{% endblock %}